(()=>{var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{AuthSettingsPage:()=>b,ConfigureWithOAuthButton:()=>y,ConfigureWithOAuthPage:()=>P,extend:()=>N});const o=flarum.reg.get("core","admin/app");var n=t.n(o);const a=flarum.reg.get("core","common/components/Button");var r=t.n(a);const s=flarum.reg.get("core","common/components/Dropdown");var i=t.n(s);const l=flarum.reg.get("core","admin/components/ExtensionPage");var u=t.n(l);const c=flarum.reg.get("core","common/components/Icon");var d=t.n(c);const f=flarum.reg.get("core","common/components/Badge");var g=t.n(f);const p=flarum.reg.get("core","common/utils/ItemList");var h=t.n(p);class b extends(u()){oninit(t){super.oninit(t),this.showing=[]}content(){return[m("div",{className:"container"},m("div",{className:"AuthSettingsPage"},m("form",{className:"Form"},this.buildSettingComponent({type:"boolean",setting:"fof-oauth.only_icons",label:n().translator.trans("fof-oauth.admin.settings.only_icons_label")}),this.buildSettingComponent({type:"boolean",setting:"fof-oauth.update_email_from_provider",label:n().translator.trans("fof-oauth.admin.settings.update_email_from_provider_label"),help:n().translator.trans("fof-oauth.admin.settings.update_email_from_provider_help")}),this.buildSettingComponent({type:"boolean",setting:"fof-oauth.fullscreenPopup",label:n().translator.trans("fof-oauth.admin.settings.fullscreen_popup_label"),help:n().translator.trans("fof-oauth.admin.settings.fullscreen_popup_help")}),this.buildSettingComponent({type:"number",setting:"fof-oauth.popupWidth",label:n().translator.trans("fof-oauth.admin.settings.popup_width_label"),help:n().translator.trans("fof-oauth.admin.settings.popup_width_help"),placeholder:580,min:0}),this.buildSettingComponent({type:"number",setting:"fof-oauth.popupHeight",label:n().translator.trans("fof-oauth.admin.settings.popup_height_label"),help:n().translator.trans("fof-oauth.admin.settings.popup_height_help"),placeholder:400,min:0}),m("hr",null),this.providerSettingsItems().toArray(),m("hr",null),m("div",{className:"AuthSettingsPage--advanced"},m("h4",null,n().translator.trans("fof-oauth.admin.settings.advanced.heading")),this.buildSettingComponent({type:"boolean",setting:"fof-oauth.log-oauth-errors",label:n().translator.trans("fof-oauth.admin.settings.advanced.log-oauth-errors-label"),help:n().translator.trans("fof-oauth.admin.settings.advanced.log-oauth-errors-help")})),this.submitButton())))]}providerSettingsItems(){const t=new(h());return n().data["fof-oauth"].map((e=>{const{name:o}=e,a=!!Number(this.setting("fof-oauth.".concat(o))()),s=!!this.showing[o],i="".concat(n().forum.attribute("baseUrl"),"/auth/").concat(o),l=this.setting("fof-oauth.".concat(o,".group"))(),u=l?n().store.getById("groups",l):null;t.add("fof-oauth.".concat(o),m("div",{className:"Provider ".concat(a?"enabled":"disabled"," ").concat(s&&"showing")},m("div",{className:"Provider--info Provider--".concat(o)},this.buildSettingComponent({type:"boolean",setting:"fof-oauth.".concat(o),label:m("div",null,"tcp-text"===e.icon?m("span",{style:{fontWeight:"bold",fontSize:"14px",letterSpacing:"0.5px"}},"TCP"):m(d(),{name:e.icon}),m("span",null,n().translator.trans("fof-oauth.lib.providers.".concat(o))))}),a&&u&&m("div",{className:"Provider--group"},m(g(),{icon:u.icon()||"fas fa-user-group"}),u.namePlural()),m(r(),{className:"Button Button--rounded ".concat(this.showing[o]&&"active"),onclick:()=>this.showing[o]=!s,"aria-label":n().translator.trans("fof-oauth.admin.settings_accessibility_label",{name:o})},m(d(),{name:"fas fa-cog"}))),m("div",{className:"Provider--settings",inert:!s},m("div",null,m("p",null,n().translator.trans("fof-oauth.admin.settings.providers.".concat(o,".description"),{link:m("a",{href:e.link,target:"_blank"},e.link)})),m("p",null,n().translator.trans("fof-oauth.admin.settings.providers.callback_url_text",{url:m("a",{href:i,target:"_blank"},i)})),Object.keys(e.fields).map((t=>this.buildSettingComponent({type:"string",setting:"fof-oauth.".concat(o,".").concat(t),label:n().translator.trans("fof-oauth.admin.settings.providers.".concat(o,".").concat(t,"_label")),required:{[s&&e.fields[t].includes("required")?"required":null]:!0}}))),this.customProviderSettings(o).toArray()))))})),t}getAvailableGroups(){return n().store.all("groups").filter((t=>!["2","3"].includes(t.id())))}customProviderSettings(t){const e=new(h());return e.add("group",m("div",{className:"Form-group"},m("label",null,n().translator.trans("fof-oauth.admin.settings.providers.group_label")),m("div",{className:"helpText"},n().translator.trans("fof-oauth.admin.settings.providers.group_help")),(()=>{const e=this.setting("fof-oauth.".concat(t,".group"))(),o=e?n().store.getById("groups",e):null,a={1:"fas fa-check",3:"fas fa-user",4:"fas fa-map-pin"};return m(i(),{label:o?[m(d(),{name:o.icon()||a[o.id()]}),"\t",o.namePlural()]:n().translator.trans("fof-oauth.admin.settings.providers.no_group_label"),buttonClassName:"Button",disabled:!this.setting("fof-oauth.".concat(t))()},m(r(),{icon:"fas fa-times",onclick:()=>this.setting("fof-oauth.".concat(t,".group"))(""),active:!e},n().translator.trans("fof-oauth.admin.settings.providers.no_group_label")),this.getAvailableGroups().map((o=>m(r(),{icon:o.icon()||a[o.id()],onclick:()=>this.setting("fof-oauth.".concat(t,".group"))(o.id()),active:e===o.id(),key:o.id()},o.namePlural()))))})())),e}}flarum.reg.add("lstechneighbor-tcp-oidc","admin/components/AuthSettingsPage",b);const v=flarum.reg.get("core","common/components/LinkButton");var _=t.n(v);class y extends(_()){view(){return[m(_(),{className:"Button",href:n().route("extension",{id:"fof-oauth"})},n().translator.trans("fof-oauth.admin.configure_button_label"))]}}flarum.reg.add("lstechneighbor-tcp-oidc","admin/components/ConfigureWithOAuthButton",y);class P extends(u()){oninit(t){super.oninit(t)}content(){return[m("div",{className:"container"},m("div",{className:"OAuthSettingsPage"},m("br",null),m(y,null)))]}}flarum.reg.add("lstechneighbor-tcp-oidc","admin/components/ConfigureWithOAuthPage",P);const S=flarum.reg.get("core","common/extenders"),N=[(new(t.n(S)().Admin)).page(b).permission((()=>({icon:"fas fa-sign-in-alt",label:n().translator.trans("fof-oauth.admin.permissions.moderate_user_providers"),permission:"moderateUserProviders"})),"moderate")]})(),module.exports=e})();
//# sourceMappingURL=admin.js.map