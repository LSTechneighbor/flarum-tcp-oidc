(()=>{var t={n:e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e),t.d(e,{AuthSettingsPage:()=>b,ConfigureWithOAuthButton:()=>y,ConfigureWithOAuthPage:()=>P,extend:()=>N});const n=flarum.reg.get("core","admin/app");var o=t.n(n);const a=flarum.reg.get("core","common/components/Button");var r=t.n(a);const i=flarum.reg.get("core","common/components/Dropdown");var s=t.n(i);const l=flarum.reg.get("core","admin/components/ExtensionPage");var c=t.n(l);const d=flarum.reg.get("core","common/components/Icon");var u=t.n(d);const g=flarum.reg.get("core","common/components/Badge");var p=t.n(g);const h=flarum.reg.get("core","common/utils/ItemList");var f=t.n(h);class b extends(c()){oninit(t){super.oninit(t),this.showing=[]}content(){return[m("div",{className:"container"},m("div",{className:"AuthSettingsPage"},m("form",{className:"Form"},this.buildSettingComponent({type:"boolean",setting:"lstechneighbor-tcp-oidc.only_icons",label:o().translator.trans("fof-oauth.admin.settings.only_icons_label")}),this.buildSettingComponent({type:"boolean",setting:"lstechneighbor-tcp-oidc.update_email_from_provider",label:o().translator.trans("fof-oauth.admin.settings.update_email_from_provider_label"),help:o().translator.trans("fof-oauth.admin.settings.update_email_from_provider_help")}),this.buildSettingComponent({type:"boolean",setting:"lstechneighbor-tcp-oidc.fullscreenPopup",label:o().translator.trans("fof-oauth.admin.settings.fullscreen_popup_label"),help:o().translator.trans("fof-oauth.admin.settings.fullscreen_popup_help")}),this.buildSettingComponent({type:"number",setting:"lstechneighbor-tcp-oidc.popupWidth",label:o().translator.trans("fof-oauth.admin.settings.popup_width_label"),help:o().translator.trans("fof-oauth.admin.settings.popup_width_help"),placeholder:580,min:0}),this.buildSettingComponent({type:"number",setting:"lstechneighbor-tcp-oidc.popupHeight",label:o().translator.trans("fof-oauth.admin.settings.popup_height_label"),help:o().translator.trans("fof-oauth.admin.settings.popup_height_help"),placeholder:400,min:0}),m("hr",null),this.providerSettingsItems().toArray(),m("hr",null),m("div",{className:"AuthSettingsPage--advanced"},m("h4",null,o().translator.trans("fof-oauth.admin.settings.advanced.heading")),this.buildSettingComponent({type:"boolean",setting:"lstechneighbor-tcp-oidc.log-oauth-errors",label:o().translator.trans("fof-oauth.admin.settings.advanced.log-oauth-errors-label"),help:o().translator.trans("fof-oauth.admin.settings.advanced.log-oauth-errors-help")})),this.submitButton())))]}providerSettingsItems(){const t=new(f());return o().data["lstechneighbor-tcp-oidc"].map((e=>{const{name:n}=e,a=!!Number(this.setting("lstechneighbor-tcp-oidc.".concat(n))()),i=!!this.showing[n],s="".concat(o().forum.attribute("baseUrl"),"/auth/").concat(n),l=this.setting("lstechneighbor-tcp-oidc.".concat(n,".group"))(),c=l?o().store.getById("groups",l):null;t.add("lstechneighbor-tcp-oidc.".concat(n),m("div",{className:"Provider ".concat(a?"enabled":"disabled"," ").concat(i&&"showing")},m("div",{className:"Provider--info Provider--".concat(n)},this.buildSettingComponent({type:"boolean",setting:"lstechneighbor-tcp-oidc.".concat(n),label:m("div",null,"tcp-text"===e.icon?m("span",{style:{fontWeight:"bold",fontSize:"14px",letterSpacing:"0.5px"}},"TCP"):m(u(),{name:e.icon}),m("span",null,o().translator.trans("fof-oauth.lib.providers.".concat(n))))}),a&&c&&m("div",{className:"Provider--group"},m(p(),{icon:c.icon()||"fas fa-user-group"}),c.namePlural()),m(r(),{className:"Button Button--rounded ".concat(this.showing[n]&&"active"),onclick:()=>this.showing[n]=!i,"aria-label":o().translator.trans("fof-oauth.admin.settings_accessibility_label",{name:n})},m(u(),{name:"fas fa-cog"}))),m("div",{className:"Provider--settings",inert:!i},m("div",null,m("p",null,o().translator.trans("fof-oauth.admin.settings.providers.".concat(n,".description"),{link:m("a",{href:e.link,target:"_blank"},e.link)})),m("p",null,o().translator.trans("fof-oauth.admin.settings.providers.callback_url_text",{url:m("a",{href:s,target:"_blank"},s)})),Object.keys(e.fields).map((t=>this.buildSettingComponent({type:"string",setting:"lstechneighbor-tcp-oidc.".concat(n,".").concat(t),label:o().translator.trans("fof-oauth.admin.settings.providers.".concat(n,".").concat(t,"_label")),required:{[i&&e.fields[t].includes("required")?"required":null]:!0}}))),this.customProviderSettings(n).toArray()))))})),t}getAvailableGroups(){return o().store.all("groups").filter((t=>!["2","3"].includes(t.id())))}customProviderSettings(t){const e=new(f());return e.add("group",m("div",{className:"Form-group"},m("label",null,o().translator.trans("fof-oauth.admin.settings.providers.group_label")),m("div",{className:"helpText"},o().translator.trans("fof-oauth.admin.settings.providers.group_help")),(()=>{const e=this.setting("lstechneighbor-tcp-oidc.".concat(t,".group"))(),n=e?o().store.getById("groups",e):null,a={1:"fas fa-check",3:"fas fa-user",4:"fas fa-map-pin"};return m(s(),{label:n?[m(u(),{name:n.icon()||a[n.id()]}),"\t",n.namePlural()]:o().translator.trans("fof-oauth.admin.settings.providers.no_group_label"),buttonClassName:"Button",disabled:!this.setting("lstechneighbor-tcp-oidc.".concat(t))()},m(r(),{icon:"fas fa-times",onclick:()=>this.setting("lstechneighbor-tcp-oidc.".concat(t,".group"))(""),active:!e},o().translator.trans("fof-oauth.admin.settings.providers.no_group_label")),this.getAvailableGroups().map((n=>m(r(),{icon:n.icon()||a[n.id()],onclick:()=>this.setting("lstechneighbor-tcp-oidc.".concat(t,".group"))(n.id()),active:e===n.id(),key:n.id()},n.namePlural()))))})())),e}}flarum.reg.add("lstechneighbor-tcp-oidc","admin/components/AuthSettingsPage",b);const v=flarum.reg.get("core","common/components/LinkButton");var _=t.n(v);class y extends(_()){view(){return[m(_(),{className:"Button",href:o().route("extension",{id:"fof-oauth"})},o().translator.trans("fof-oauth.admin.configure_button_label"))]}}flarum.reg.add("lstechneighbor-tcp-oidc","admin/components/ConfigureWithOAuthButton",y);class P extends(c()){oninit(t){super.oninit(t)}content(){return[m("div",{className:"container"},m("div",{className:"OAuthSettingsPage"},m("br",null),m(y,null)))]}}flarum.reg.add("lstechneighbor-tcp-oidc","admin/components/ConfigureWithOAuthPage",P);const S=flarum.reg.get("core","common/extenders"),N=[(new(t.n(S)().Admin)).page(b).permission((()=>({icon:"fas fa-sign-in-alt",label:o().translator.trans("fof-oauth.admin.permissions.moderate_user_providers"),permission:"moderateUserProviders"})),"moderate")]})(),module.exports=e})();
//# sourceMappingURL=admin.js.map